<!DOCTYPE HTML>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, viewport-fit=cover" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
    <link rel="stylesheet" href="../styles/bootstrap.css">
    <link rel="stylesheet" href="../fonts/bootstrap-icons.css">
    <link rel="stylesheet" href="../styles/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <meta id="theme-check" name="theme-color" content="#FFFFFF">
    <link rel="stylesheet" href="../../modal/modal.css">
    <title> Withdrawal Confirmation | Vitron-trade </title>

    <style>
          .color-highlight {
            color: #F6BB42 !important;
        }

        .bg-highlight {
            background-color: #F6BB42 !important;
            color: #FFF !important;
        }

        .border-highlight {
            border-color: #F6BB42 !important;
        }

        .gradient-highlight {
            background-image: linear-gradient(to bottom, #FFCE54, #F6BB42) !important;
        }

        .splide__pagination__page.is-active {
            background-color: #F6BB42 !important;
        }

        .footer-bar-1 .active-nav i,
        .footer-bar-1 .active-nav span {
            color: #F6BB42 !important;
        }

        .footer-bar-2 .active-nav {
            border-bottom: solid 3px #F6BB42;
        }

        .footer-bar-3 .active-nav {
            border-top: solid 3px #F6BB42;
        }

        .footer-bar-4 .active-nav {
            background-color: #F6BB42;
        }

        #footer-bar .circle-nav-1::after,
        #footer-bar .circle-nav-2::before,
        #footer-bar .circle-nav-2::after {
            background-image: linear-gradient(to bottom, #FFCE54, #F6BB42) !important;
        }

        input[type=range]::-webkit-slider-thumb {
            background-color: #F6BB42;
        }

        .color-highlight {
            color: #F6BB42;
        }

        .bg-highlight {
            background-color: #F6BB42;
            color: #FFF !important;
        }

        #header-deco-1,
        #header-deco-2,
        #header-deco-3,
        #header-deco-4 {
            fill: #F6BB42;
        }

        .error {
            color: #d84558 !important;
            background-color: rgba(218, 68, 83, .2) !important;
            color: #fff !important;
            position: relative;
            padding: 1rem 1rem;
            padding-right: 1rem;
            margin-bottom: 1rem;
            border: 1px solid transparent;
            border-radius: .25rem;
            transition: opacity .15s linear;
        }

        .card-style {
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s;
        }

        body.theme-dark .card-style {
            background-color: var(--dark-card);
        }

        body.theme-light .card-style {
            background-color: var(--light-card);
        }

        .color-highlight {
            color: var(--highlight-color) !important;
        }

        .bg-highlight {
            background-color: var(--highlight-color) !important;
            color: #FFF !important;
        }

        .border-highlight {
            border-color: var(--highlight-color) !important;
        }

        .gradient-highlight {
            background-image: linear-gradient(to bottom, #FFCE54, #F6BB42) !important;
        }

        .footer-bar-1 .active-nav i,
        .footer-bar-1 .active-nav span {
            color: var(--highlight-color) !important;
        }

        input[type=range]::-webkit-slider-thumb {
            background-color: var(--highlight-color);
        }

        .error {
            color: #d84558 !important;
            background-color: rgba(218, 68, 83, .2) !important;
            color: #fff !important;
            position: relative;
            padding: 1rem 1rem;
            padding-right: 1rem;
            margin-bottom: 1rem;
            border: 1px solid transparent;
            border-radius: .25rem;
            transition: opacity .15s linear;
        }

      
    
        .wallet-input {
            border-radius: 8px;
            padding: 10px;
            border: 1px solid #ddd;
            background-color: transparent;
            transition: border-color 0.3s;
            width: 100%;
        }

    
        .form-label {
            font-weight: 600;
            margin-bottom: 8px;
        }

        .crypto-icon {
            width: 24px;
            height: 24px;
            margin-right: 10px;
            vertical-align: middle;
        }


 
    </style>
</head>

<body class="theme-light">

    <div id="preloader">
        <div class="spinner-border color-highlight" role="status"></div>
    </div>

    
<!-- Footer Bar -->
<div id="footer-bar" class="footer-bar-1 footer-bar-detached">
    <a href="./earn.html"><i class="bi bi-piggy-bank"></i><span>Earn</span></a>
    <a href="./account-history.html"><i class="bi bi-calendar4-event"></i><span>Activity</span></a>
    <a href="../Dashboard.html" class="circle-nav-2"><i class="bi bi-house-fill"></i><span>Wallet</span></a>
    <a href="./explore.html"><i class="bi bi-grid"></i><span>Explore</span></a>
    <a href="./profile-settings.html" data-bs-toggle="offcanvas" data-bs-target="#menu-sidebar"><i
            class="bi bi-gear"></i><span>Settings</span></a>
</div>

    <!-- Page Title-->
    <div class="pt-3">
        <div class="page-title d-flex">
            <div class="align-self-center">
                <a href="../Dashboard.html" onclick="window.location.href='../Dashboard.html'; return false;"
                    class="me-3 ms-0 icon icon-xxs bg-theme rounded-s shadow-m">
                    <i class="bi bi-chevron-left color-theme font-14"></i>
                </a>

            </div>
            <div class="align-self-center me-auto">
                <h1 class="color-theme mb-0 font-18">Withdrawal confirmation</h1>
            </div>

        </div>
    </div>

    <div class="container mt-2">
        <div class="card card-style overflow-visible" style="box-shadow: 0 8px 25px rgba(0,0,0,0.25);">
            <div class="content mb-0 p-1">
                <div class="table-responsive">
                    <table class="table color-theme mb-4">
                        <tr>
                            <th class="color-theme" style="white-space: nowrap;">Withdrawal Amount:</th>
                            <td class="color-theme" id="withdrawalAmount">$0.00</td>
                        </tr>
                        <tr>
                            <th class="color-theme" style="white-space: nowrap;">Processing Fee:</th>
                            <td class="color-theme" id="processingFee">$0.00</td>
                        </tr>
                        <tr>
                            <th class="color-theme" style="white-space: nowrap;">Net Amount:</th>
                            <td class="color-theme" id="netAmount">$0.00</td>
                        </tr>
                        <tr>
                            <th class="color-theme" style="white-space: nowrap;">Payment Method:</th>
                            <td class="color-theme" id="selectedMethod">BTC</td>
                        </tr>
                        <tr>
                            <th class="color-theme" style="white-space: nowrap;">wallet Address</th>
                            <td class="color-theme" id="walletAddress">xxxxx</td>
                        </tr>
                    </table>

                    <div class="mb-4 p-3 color-theme rounded" style="background-color: rgba(255, 179, 26, 0.37); box-shadow: 0 8px 25px rgba(0,0,0,0.25);">
                        <h6 class="color-theme">Important Notice</h6>
                        <p class="small mb-0 color-theme">Withdrawals may take 1-24 hours to process. Ensure the wallet address is correct as transactions cannot be reversed.</p>
                    </div>

                    <!-- Confirm Withdrawal Button -->
                    <div class="text-center mt-3">
                        <button class="btn btn btn-warning px-4 py-3 mb-3 w-100" id="confirmWithdrawalBtn">
                            Confirm Withdrawal
                        </button>
                    </div>
                    
                </div>
            </div>
        </div>
    </div>



    <!-- Success Modal -->
    <!-- <div id="successModal" class="offcanvas offcanvas-modal offcanvas-detached rounded-m" style="display: none;">
        <div class="content text-center">
            <i style="font-size:65px;" class="scale-box fas fa-check-circle color-green-dark shadow-s rounded-circle p-0 mt-3 mb-3 d-inline-block"></i>
            <h1 class="pt-3 font-28">Success</h1>
            <p class="font-14 mb-0">
                Your withdrawal request has been submitted successfully.
            </p>
            <a href="#" data-bs-dismiss="modal" class="btn btn-full gradient-green shadow-bg shadow-bg-xs mt-3">Okay</a>
        </div>
    </div> -->

    <!--Withdrawal Processing Modal -->
          <div class="modal fade p-2" id="withdrawalModal" tabindex="-1" aria-labelledby="withdrawalModalLabel"
            aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content text-center theme-dark p-4" style="border-radius: 16px; 
                   box-shadow: 0 8px 25px rgba(0,0,0,0.25); transition: all 0.3s ease-in-out;">
                    <h5 id="withdrawalModalLabel" class="mb-3">Processing Payment</h5>
                    <div class="d-flex justify-content-center mb-3">
                        <div class="spinner-border text-success" role="status" style="width: 2.5rem; height: 2.5rem;"></div>
                    </div>
                    <p class="theme-dark">Please wait while we verify your payment.<br>This may take a few minutes.</p>
                    <button type="button" class="btn btn-secondary mt-2" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
        <script src="../scripts/bootstrap.min.js"></script>
        <script src="../scripts/custom.js"></script>
        <script src="../../js/mainAuth.js"></script>
        <script src="../../js/withdrawal.js"></script>
        <script src="../../modal/modal.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function(){
            const withdrawalData = JSON.parse(localStorage.getItem('pendingWithdrawal'));
        
            if (!withdrawalData) {
                // Redirect back if no data
                window.location.href = '../dashboard.html';
                return;
            }
            displayWithdrawalDetails(withdrawalData);
            document.getElementById('confirmWithdrawalBtn').addEventListener('click', function() {
                 processWithdrawal(withdrawalData);
            });
        });

        function displayWithdrawalDetails(data) {
            document.getElementById('selectedMethod').textContent = data.displayMethod;
            document.getElementById('withdrawalAmount').textContent = `$${data.amount.toFixed(2)}`;
            document.getElementById('netAmount').textContent = `$${data.amount.toFixed(2)}`;
            document.getElementById('walletAddress').textContent = data.walletAddress;
            // document.getElementById('confirmationDate').textContent = new Date(data.timestamp).toLocaleString();
        }

        async function processWithdrawal(formData){
          const submitBtn = document.getElementById('confirmWithdrawalBtn')           
          submitBtn.disabled = true;
            submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Processing...';

            try {
                const result = await submitWithdrawal(formData);
                // Clear stored data
                localStorage.removeItem('pendingWithdrawal');
            } catch (error) {
                console.log(error)
                // Re-enable buttons
                submitBtn.disabled = false;
                submitBtn.textContent = 'Confirm Withdrawal';
            }
        }

    
    </script>

<script>
    // Define the pwaName variable that matches your main JS file
    const pwaName = "PayApp";
    
    // Function to apply the theme from localStorage
    function applyStoredTheme() {
        const savedTheme = localStorage.getItem(pwaName + '-Theme');
        console.log("Stored theme:", savedTheme); // For debugging
        
        if (savedTheme === 'dark-mode') {
            document.body.classList.add('theme-dark');
            document.body.classList.remove('theme-light');
            console.log("Applied dark theme"); // For debugging
        } else if (savedTheme === 'light-mode') {
            document.body.classList.add('theme-light');
            document.body.classList.remove('theme-dark');
            console.log("Applied light theme"); // For debugging
        }
        
        // Update theme-color meta tag
        const themeColor = savedTheme === 'dark-mode' ? '#1f1f1f' : '#FFFFFF';
        document.getElementById('theme-check').setAttribute('content', themeColor);
    }
    
    // Apply the theme when the page loads
    document.addEventListener('DOMContentLoaded', function() {
        applyStoredTheme();
        
        // Optional: Add an event listener to handle theme changes
        // This would be useful if you have a theme toggle on this page
        window.addEventListener('storage', function(e) {
            if (e.key === pwaName + '-Theme') {
                applyStoredTheme();
            }
        });
    });
</script>
    <!-- <script src="../scripts/bootstrap.min.js"></script>
    <script src="../scripts/custom.js"></script>
    <script src="../../js/mainAuth.js"></script>
    <script src="../../js/withdrawal.js"></script> -->
</body>

</html>